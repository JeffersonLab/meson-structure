# meson-structure

Meson Structure Analysis

[The full documentation](https://jeffersonlab.github.io/meson-structure/)


## Λ-reconstruction and Kaon Structure Function Studies

The branch ***analysis/multi-calo-lambda*** of the **meson-structure** repository provides a lightweight and user-friendly Python framework to:

- Read reconstructed Λ candidates from EICrecon outputs,  
- Compare reconstructed vs Geant4 and afterburner angles and spectra,
- Produce kinematic maps,  
- Propagate statistical uncertainties to the kaon structure function*.

\* The error propagation is based on the assumption that the kaon structure function is proportional to the number of $\Lambda^0$ hyperons produced by the Sullivan process, $F_k\propto N_\Lambda$. This number is related to the reconstruction efficiency $\varepsilon$, the cross-section $\sigma$, and the EIC luminosity $L$, as $N_\Lambda=\varepsilon\times \sigma \times L $. Assuming Poisson statistics, the relative error is estimated as 

$$
\frac{\Delta F_k}{F_k} = \frac{1}{\sqrt{N_\Lambda}} = \frac{1}{\sqrt{\varepsilon \times \sigma \times L}} = \sqrt{\frac{N_\Lambda^{simu}}{N_\Lambda^{reco} \times \sigma\times L}}
$$

### Read or generate reconstructed ROOT Files with EICrecon

The input files must be generated by the branch *reco/lambda-ff-multicalo* of EICrecon, leveraging several calorimeters (EndcapP-Ecal, LFHCAL, B0-Ecal and ZDC-Hcal) to reconstruct $\Lambda^0$ hyperons from the Sullivan process from the neutral decay products $\Lambda^0 \rightarrow n+\gamma_1+\gamma_2$.

Reconstructed files are already available within ***/work/eic3/users/fraisse/meson-structure/data/***. 

They can also be (re)generated from the simulation campaign files, for example those available in */volatile/eic/romanov/meson-structure-2026-02*, using the dedicated branch of EICrecon *reco/lambda-ff-multicalo* and the compatible container *eic_xl:25.11-stable*. 


### Run the post-analysis

Before running the analysis, you may update *meson-structure/analysis/multicalo-lambda/config.py* with the paths matching your working space. The current paths should work from iFarm without any change for the Summer 2025 simulation campaign.

You can now launch the post-analysis within *meson-structure/analysis/multicalo-lambda/*, using for example

```bash
python -m run --task all --nfiles 1 --suffix testall_calocalib_verification
```

### General use and options:

Location:
- *meson-structure/analysis/multicalo-lambda/*

Run:
- python -m run --task <task> [options]

Input files:
- `k_lambda_<beam>_5000evt_<idx>_<suffix>.root`
- Files read: 001 → --nfiles

Tasks:
- all       : full analysis
- angles    : angular distributions
- spectra   : energy spectra
- eff       : efficiencies
- kin       : kinematic maps
- relerr    : statistical uncertainty projection

Options:
- --nfiles : number of files to analyze
- --suffix : tag of files (if so)
- --beam : '5x41', '10x100', or '18x275'
- --bins : binning
- --lumin-fb : luminosity ($fb^{-1}$)
- --logQ2 : linear (false) or log (true) scale for $Q^2$
- --with-beta : normalization of efficiency to the neutral branching ratio
- --tmax : cut in |*-t*| (GeV)


### Outputs

All figures are automatically saved to: ***meson-structure/analysis/multicalo-lambda/outputs/***.

Examples:
- `spectrum_<beam>_testall_<suffix>.png`  
- `kinematics_xB_Q2_<beam>_<suffix>.png`  
- `relerr_xK_Q2_<beam>_<suffix>_L5fb_linQ2.png`
- etc.

### TO DO LIST

- [physics] Include the experimental kinematics reconstruction (e-, JB) from EICrecon.
- [physics] Attach the uncertainties to Kaon SF models to see if discriminating.
- [physics] Include other sources of error than purely statistical  ones (e.g. $\Delta\sigma$ from event generator)
- [ESR] Include Zenobo figures plot format (https://zenodo.org/records/16615455) 